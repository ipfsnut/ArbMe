[phases.setup]
nixPkgs = ["nodejs_20"]

[phases.install]
cmds = [
  "npm ci"
]

[phases.build]
cmds = [
  "npm run build --workspace=@arbme/core-lib",
  "npm run build --workspace=@arbme/nextjs",
  "ls -la packages/nextjs/.next/ || echo 'No .next directory'",
  "ls -la packages/nextjs/.next/standalone/ || echo 'No standalone directory'",
  "cp -r packages/nextjs/.next/static packages/nextjs/.next/standalone/packages/nextjs/.next/static || echo 'Failed to copy static files'"
]

[start]
cmd = "npm run server --workspace=arbme-market-maker-bot"
